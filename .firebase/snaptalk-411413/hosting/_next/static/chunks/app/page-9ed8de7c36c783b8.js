(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3278:function(e,t,s){Promise.resolve().then(s.bind(s,5219))},5219:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var l=s(7437),a=s(4033),r=s(2265);function n(e){let{setContactDetails:t}=e,[s,a]=(0,r.useState)([]),[n,i]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{(async()=>{let e=localStorage.getItem("token");try{let t=await fetch("https://snap-talk.adaptable.app/user",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();a(e.user.contacts),i(!1)}}catch(e){console.log(e)}})()},[]),(0,l.jsxs)(l.Fragment,{children:[n?(0,l.jsxs)("div",{className:"lds-ellipsis absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:[(0,l.jsx)("div",{}),(0,l.jsx)("div",{}),(0,l.jsx)("div",{})]}):"",s.length>0&&s.map(e=>(0,l.jsxs)("div",{className:"flex h-16 cursor-pointer items-center gap-2 px-2 font-semibold text-gray-200",onClick:()=>t(e),children:[e.profilePicture?(0,l.jsx)("img",{src:e.profilePicture,alt:"profile",className:"h-4/5 w-auto rounded-full"}):(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"h-4/5 fill-gray-200",children:[(0,l.jsx)("title",{children:"account-circle"}),(0,l.jsx)("path",{d:"M12,19.2C9.5,19.2 7.29,17.92 6,16C6.03,14 10,12.9 12,12.9C14,12.9 17.97,14 18,16C16.71,17.92 14.5,19.2 12,19.2M12,5A3,3 0 0,1 15,8A3,3 0 0,1 12,11A3,3 0 0,1 9,8A3,3 0 0,1 12,5M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z"})]}),(0,l.jsx)("div",{className:"w-full border-b border-neutral-500 py-4",children:e.username})]},e._id))]})}function i(e){let{contactDetails:t}=e;return(0,l.jsx)(l.Fragment,{children:Object.keys(t).length?(0,l.jsxs)("div",{className:"flex h-16 cursor-pointer items-center gap-2 px-2",children:[""!==t.profilePicture?(0,l.jsx)("img",{src:t.profilePicture,alt:"profile",className:"h-10 w-auto rounded-full"}):(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"h-12 fill-gray-200",children:[(0,l.jsx)("title",{children:"account-circle"}),(0,l.jsx)("path",{d:"M12,19.2C9.5,19.2 7.29,17.92 6,16C6.03,14 10,12.9 12,12.9C14,12.9 17.97,14 18,16C16.71,17.92 14.5,19.2 12,19.2M12,5A3,3 0 0,1 15,8A3,3 0 0,1 12,11A3,3 0 0,1 9,8A3,3 0 0,1 12,5M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z"})]}),(0,l.jsx)("div",{className:"font-semibold text-gray-200",children:t.username})]},t._id):""})}function c(e){let{contactDetails:t,setMessages:s}=e,[a,n]=(0,r.useState)(""),[i,c]=(0,r.useState)(null),o=(0,r.useRef)(null),d=localStorage.getItem("id");async function u(){if(null===i&&""===a||null!==i&&""!==a)return;console.log(i,a);let e=localStorage.getItem("token"),l="Bearer ".concat(e),r=new FormData;r.append("receiverId",t._id),r.append("content[type]",a?"text":"image"),r.append("content[data]",a),null!==i&&r.append("image",i);try{(await fetch("https://snap-talk.adaptable.app/messages",{method:"POST",headers:{Authorization:l},body:r})).ok&&(n(""),(async()=>{let e=await fetch("https://snap-talk.adaptable.app/messages/".concat(t._id),{method:"GET",headers:{"Content-Type":"application/json",Authorization:l}});if(e.ok){let t=(await e.json()).messages.map(e=>({...e,isUser:e.sender===d}));s(t)}})())}catch(e){console.log(e)}}return(0,l.jsx)("form",{children:(0,l.jsxs)("div",{className:"flex h-14 items-center gap-2 bg-neutral-600 px-2 py-2",children:[(0,l.jsx)("button",{onClick:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.click()},type:"button",children:(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"h-full w-8 fill-gray-200",children:[(0,l.jsx)("title",{children:"image"}),(0,l.jsx)("path",{d:"M8.5,13.5L11,16.5L14.5,12L19,18H5M21,19V5C21,3.89 20.1,3 19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19Z"})]})}),(0,l.jsx)("input",{id:"file",type:"file",accept:"image/*",onChange:e=>c(e.target.files?e.target.files[0]:null),ref:o,style:{display:"none"}}),(0,l.jsx)("input",{type:"text",className:"h-full w-full rounded-md bg-neutral-500 px-4 text-gray-200 outline-none",value:a,onChange:e=>n(e.target.value),placeholder:" Type a message"}),(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",onClick:u,className:"h-full w-8 cursor-pointer fill-gray-200",children:[(0,l.jsx)("title",{children:"send"}),(0,l.jsx)("path",{d:"M2,21L23,12L2,3V10L17,12L2,14V21Z"})]})]})})}var o=function(){for(var e,t,s=0,l="",a=arguments.length;s<a;s++)(e=arguments[s])&&(t=function e(t){var s,l,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t){if(Array.isArray(t)){var r=t.length;for(s=0;s<r;s++)t[s]&&(l=e(t[s]))&&(a&&(a+=" "),a+=l)}else for(l in t)t[l]&&(a&&(a+=" "),a+=l)}return a}(e))&&(l&&(l+=" "),l+=t);return l};function d(e){let{contactDetails:t}=e,[s,a]=(0,r.useState)([]),[n,d]=(0,r.useState)(!0),u=localStorage.getItem("id");(0,r.useEffect)(()=>{d(!0),(async()=>{let e=localStorage.getItem("token");try{if(!h(t)){let s=await fetch("https://snap-talk.adaptable.app/messages/".concat(t._id),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(s.ok){let e=(await s.json()).messages.map(e=>({...e,isUser:e.sender===u}));a(e),d(!1)}}}catch(e){console.log(e)}})()},[t,u]);let h=e=>!Object.keys(e).length;return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex h-screen flex-col",children:[(0,l.jsx)("div",{className:"flex-none",children:(0,l.jsx)(i,{contactDetails:t})}),(0,l.jsx)("div",{className:"relative flex-1 overflow-y-auto bg-neutral-800 text-gray-200",children:n?(0,l.jsxs)("div",{className:"lds-ellipsis absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:[(0,l.jsx)("div",{}),(0,l.jsx)("div",{}),(0,l.jsx)("div",{})]}):(0,l.jsx)("div",{className:"mx-2 my-4 grid gap-4",children:s.length>0?s.map(e=>(0,l.jsx)("div",{className:o(e.isUser?"justify-self-end":"justify-self-start"),children:"text"===e.content.type?(0,l.jsx)("div",{className:"rounded-md bg-neutral-600 px-4 py-2",children:e.content.data}):(0,l.jsx)("img",{src:e.content.data,alt:e.content.type,className:"h-4/5 rounded-md bg-neutral-600 p-4"})},e._id)):(0,l.jsx)("div",{className:"color-gray-200 justify-self-center",children:"You have no conversation with this user"})})}),!h(t)&&(0,l.jsx)("div",{className:"flex-none",children:(0,l.jsx)(c,{contactDetails:t,setMessages:a})})]})})}function u(e){let{setEditProfile:t}=e,[s,a]=(0,r.useState)({}),[n,i]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=localStorage.getItem("token"),t="Bearer ".concat(e);(async()=>{try{let e=await fetch("https://snap-talk.adaptable.app/user",{headers:{Authorization:t}});if(e.ok){let t=await e.json();a(t.user),i(!1)}}catch(e){console.log(e)}})()},[]),(0,l.jsx)(l.Fragment,{children:n?(0,l.jsxs)("div",{className:"lds-ellipsis absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:[(0,l.jsx)("div",{}),(0,l.jsx)("div",{}),(0,l.jsx)("div",{})]}):(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("nav",{className:"flex h-16 items-center bg-neutral-600 px-2 text-gray-100",children:(0,l.jsxs)("div",{className:"flex cursor-pointer items-center gap-2 rounded-md p-2",onClick:()=>t(!0),children:[""!==s.profilePicture?(0,l.jsx)("img",{src:s.profilePicture,alt:"",className:"h-10 w-auto rounded-full"}):(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"h-10 rounded-full fill-gray-200",children:[(0,l.jsx)("title",{children:"account-circle"}),(0,l.jsx)("path",{d:"M12,19.2C9.5,19.2 7.29,17.92 6,16C6.03,14 10,12.9 12,12.9C14,12.9 17.97,14 18,16C16.71,17.92 14.5,19.2 12,19.2M12,5A3,3 0 0,1 15,8A3,3 0 0,1 12,11A3,3 0 0,1 9,8A3,3 0 0,1 12,5M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z"})]}),(0,l.jsx)("div",{className:"font-semibold",children:s&&s.username})]})})})})}function h(e){let{setEditProfile:t}=e,[s,a]=(0,r.useState)({}),[n,i]=(0,r.useState)(!1),[c,o]=(0,r.useState)(!1),[d,u]=(0,r.useState)(""),[h,x]=(0,r.useState)(""),[p,f]=(0,r.useState)(null),g=(0,r.useRef)(null),[m,j]=(0,r.useState)(!0),v=()=>{i(!0)},w=()=>{o(!0)},y=()=>{i(!1)},N=()=>{o(!1)};async function b(e){e.preventDefault();let t=localStorage.getItem("token"),s="Bearer ".concat(t),l=new FormData;l.append("username",h),l.append("email",d),null!==p&&l.append("image",p);try{if((await fetch("https://snap-talk.adaptable.app/user",{method:"POST",headers:{Authorization:s},body:l})).ok)try{let e=await fetch("https://snap-talk.adaptable.app/user",{method:"GET",headers:{Authorization:s}});if(e.ok){let t=await e.json();a(t.user),x(t.user.username),u(t.user.email)}}catch(e){console.log(e)}}catch(e){console.log(e)}}return(0,r.useEffect)(()=>{let e=localStorage.getItem("token"),t="Bearer ".concat(e);(async()=>{try{let e=await fetch("https://snap-talk.adaptable.app/user",{method:"GET",headers:{Authorization:t}});if(e.ok){let t=await e.json();a(t.user),x(t.user.username),u(t.user.email),j(!1)}}catch(e){console.log(e)}})()},[]),(0,l.jsx)(l.Fragment,{children:m?(0,l.jsxs)("div",{className:"lds-ellipsis absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:[(0,l.jsx)("div",{}),(0,l.jsx)("div",{}),(0,l.jsx)("div",{})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("nav",{className:"flex h-14 items-center gap-4 px-4 text-gray-200",children:[(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"h-6 w-6 cursor-pointer fill-gray-200",onClick:()=>t(!1),children:[(0,l.jsx)("title",{children:"arrow-left"}),(0,l.jsx)("path",{d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"})]}),(0,l.jsx)("div",{children:"Your profile"})]}),(0,l.jsxs)("div",{className:"mt-6 flex flex-col items-center gap-6 px-4 text-gray-200",children:[""!==s.profilePicture?(0,l.jsxs)("div",{className:"relative",children:[s.profilePicture&&(0,l.jsx)("img",{src:s.profilePicture,alt:"profile",className:"h-60 w-auto rounded-full brightness-75"}),(0,l.jsxs)("div",{className:"h-full w-full cursor-pointer",children:[(0,l.jsx)("button",{onClick:()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.click()},className:"absolute left-1/2 top-1/2 h-8 w-8 -translate-x-1/2 -translate-y-1/2 cursor-pointer border-none bg-transparent",children:(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"fill-gray-200",children:[(0,l.jsx)("title",{children:"pencil"}),(0,l.jsx)("path",{d:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"})]})}),(0,l.jsx)("input",{id:"file",type:"file",accept:"image/*",onChange:e=>f(e.target.files?e.target.files[0]:null),ref:g,style:{display:"none"}})]})]}):(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"h-60 rounded-full fill-gray-200 brightness-75",children:[(0,l.jsx)("title",{children:"account-circle"}),(0,l.jsx)("path",{d:"M12,19.2C9.5,19.2 7.29,17.92 6,16C6.03,14 10,12.9 12,12.9C14,12.9 17.97,14 18,16C16.71,17.92 14.5,19.2 12,19.2M12,5A3,3 0 0,1 15,8A3,3 0 0,1 12,11A3,3 0 0,1 9,8A3,3 0 0,1 12,5M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z"})]}),(0,l.jsxs)("div",{className:"h-full w-full cursor-pointer",children:[(0,l.jsx)("button",{onClick:()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.click()},className:"absolute left-1/2 top-1/2 h-8 w-8 -translate-x-1/2 -translate-y-1/2 cursor-pointer border-none bg-transparent",children:(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"fill-gray-200",children:[(0,l.jsx)("title",{children:"pencil"}),(0,l.jsx)("path",{d:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"})]})}),(0,l.jsx)("input",{id:"file",type:"file",accept:"image/*",onChange:e=>f(e.target.files?e.target.files[0]:null),ref:g,style:{display:"none"}})]})]}),(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("div",{className:"text-sm",children:"Your Username"}),(0,l.jsx)("div",{className:"mt-2 flex w-full items-center text-lg",children:c?(0,l.jsxs)("div",{className:"flex w-full items-center border-b border-neutral-500",children:[(0,l.jsx)("input",{type:"text",value:h,onChange:e=>x(e.target.value),className:"flex-grow  bg-transparent py-1 outline-none"}),(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"h-6 cursor-pointer fill-gray-200",onClick:c?N:w,children:[(0,l.jsx)("title",{children:"check-bold"}),(0,l.jsx)("path",{d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"})]})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"grow",children:(0,l.jsx)("div",{className:"py-1",children:s&&h})}),(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"h-6 cursor-pointer fill-gray-200",onClick:c?N:w,children:[(0,l.jsx)("title",{children:"pencil"}),(0,l.jsx)("path",{d:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"})]})]})})]}),(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("div",{className:"text-sm",children:"Your email"}),(0,l.jsx)("div",{className:"mt-2 flex w-full items-center text-lg",children:n?(0,l.jsxs)("div",{className:"flex w-full items-center border-b border-neutral-500",children:[(0,l.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),className:"flex-grow  bg-transparent py-1 outline-none"}),(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"h-6 cursor-pointer fill-gray-200",onClick:n?y:v,children:[(0,l.jsx)("title",{children:"check-bold"}),(0,l.jsx)("path",{d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"})]})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"grow",children:(0,l.jsx)("div",{className:"py-1",children:s&&d})}),(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"h-6 cursor-pointer fill-gray-200",onClick:n?y:v,children:[(0,l.jsx)("title",{children:"pencil"}),(0,l.jsx)("path",{d:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"})]})]})})]}),(0,l.jsx)("button",{onClick:e=>b(e),className:"rounded bg-neutral-600 p-2 text-gray-200 hover:bg-neutral-500 active:bg-neutral-700",children:"Save"})]})]})})}function x(){return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-center text-gray-200",children:[(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"h-auto w-40 fill-gray-200",children:[(0,l.jsx)("title",{children:"message"}),(0,l.jsx)("path",{d:"M20,2H4A2,2 0 0,0 2,4V22L6,18H20A2,2 0 0,0 22,16V4C22,2.89 21.1,2 20,2Z"})]}),(0,l.jsx)("div",{className:"text-2xl font-semibold",children:"SnapTalk"}),(0,l.jsx)("div",{className:"mt-2",children:"Send and receive text or images to friends."})]})})}function p(){let[e,t]=(0,r.useState)({}),[s,i]=(0,r.useState)(!1),c=(0,a.useRouter)();return(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("https://snap-talk.adaptable.app/verifyToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:localStorage.getItem("token")})});if(401===e.status){let t=await e.json();console.log(t.error),c.push("/login")}}catch(e){console.log(e)}})()}),(0,l.jsx)("main",{className:"flex h-screen w-screen justify-center bg-neutral-900",children:(0,l.jsxs)("div",{className:"grid h-screen w-4/5 grid-cols-6",children:[(0,l.jsx)("div",{className:"relative col-span-2 border-r border-neutral-500 bg-neutral-800",children:s?(0,l.jsx)(h,{setEditProfile:i}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"relative h-16 w-full bg-neutral-600",children:(0,l.jsx)(u,{setEditProfile:i})}),(0,l.jsx)(n,{setContactDetails:t})]})}),(0,l.jsx)("div",{className:"col-span-4 bg-neutral-600",children:Object.keys(e).length?(0,l.jsx)(d,{contactDetails:e}):(0,l.jsx)(x,{})})]})})}},622:function(e,t,s){"use strict";var l=s(2265),a=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function o(e,t,s){var l,r={},o=null,d=null;for(l in void 0!==s&&(o=""+s),void 0!==t.key&&(o=""+t.key),void 0!==t.ref&&(d=t.ref),t)n.call(t,l)&&!c.hasOwnProperty(l)&&(r[l]=t[l]);if(e&&e.defaultProps)for(l in t=e.defaultProps)void 0===r[l]&&(r[l]=t[l]);return{$$typeof:a,type:e,key:o,ref:d,props:r,_owner:i.current}}t.Fragment=r,t.jsx=o,t.jsxs=o},7437:function(e,t,s){"use strict";e.exports=s(622)},4033:function(e,t,s){e.exports=s(5313)}},function(e){e.O(0,[971,938,744],function(){return e(e.s=3278)}),_N_E=e.O()}]);